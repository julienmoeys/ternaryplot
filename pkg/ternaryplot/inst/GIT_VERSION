eabb11d Refactoring, coherence changes
